import{a as b,b as N,r as a,j as o,L as j,B as y,y as n,i as A}from"./index-CUOtPIL2.js";import{M as _}from"./MovieService-DFnUauZq.js";import{u as P}from"./useFetch-BXXdbUT3.js";const I="_container_1o96b_1",D="_moviePosterAndTrailer_1o96b_19",M="_moviePoster_1o96b_19",S="_movieTrailer_1o96b_57",B="_formContainer_1o96b_75",O="_formTitle_1o96b_101",W="_formWrapper_1o96b_115",R="_movieReleaseDate_1o96b_147",E="_movieVoteAverage_1o96b_151",F="_movieGenreIds_1o96b_153",C="_movieDownWrapper_1o96b_165",G="_movieOverview_1o96b_179",V="_movieButton_1o96b_355",r={container:I,moviePosterAndTrailer:D,moviePoster:M,movieTrailer:S,formContainer:B,formTitle:O,formWrapper:W,movieReleaseDate:R,movieVoteAverage:E,movieGenreIds:F,movieDownWrapper:C,movieOverview:G,movieButton:V},p="failed-to-fetch-trailer",$=()=>{var f;const{id:i}=b(),v=N(),[e,h]=a.useState(null),[c,u]=a.useState(null),[g,l,d]=P(async t=>await _.getMovieById(t));if(a.useEffect(()=>{i&&g(i).then(t=>{t&&h(t)})},[i]),a.useEffect(()=>{i&&(async()=>{var m;try{const s=await _.getMovieTrailer(i);u(s)}catch(s){if(console.error("Failed to fetch trailer",s),!c&&!n.isActive(p)){const T=A(s)&&s.response&&((m=s.response.data)==null?void 0:m.message)||"Failed to fetch trailer";n.error(T,{toastId:p})}}})()},[i]),a.useEffect(()=>{!l&&d&&v("/forbidden")},[l,d,v]),l)return o.jsx(j,{});if(!e)return null;const x=e.poster_path?`https://image.tmdb.org/t/p/w500${e.poster_path}`:"https://via.placeholder.com/500x750?text=No+Poster",w=()=>{const t=JSON.parse(localStorage.getItem("favorites")||"[]");t.some(s=>s.id===e.id)?n.info("This movie was added!"):(localStorage.setItem("favorites",JSON.stringify([...t,e])),n.info("Movie was added at the favorites!"))};return o.jsxs("div",{className:r.container,children:[o.jsxs("div",{className:r.moviePosterAndTrailer,children:[o.jsx("img",{loading:"lazy",src:x,alt:e==null?void 0:e.title,className:r.moviePoster}),c&&o.jsx("iframe",{className:r.movieTrailer,src:`https://www.youtube.com/embed/${c}`,title:"YouTube trailer",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})]}),o.jsxs("div",{className:r.formContainer,children:[o.jsx("h1",{className:r.formTitle,children:e.original_title}),o.jsxs("div",{className:r.formWrapper,children:[o.jsxs("h3",{className:r.movieReleaseDate,children:["Release: ",e.release_date]}),o.jsxs("h4",{className:r.movieVoteAverage,children:["Rating: ",e!=null&&e.vote_average?e.vote_average.toFixed(1):"No rating"]}),o.jsxs("h4",{className:r.movieGenreIds,children:["Genres: ",(f=e==null?void 0:e.genres)==null?void 0:f.map(t=>t.name).join(", ")]})]}),o.jsxs("div",{className:r.movieDownWrapper,children:[o.jsxs("p",{className:r.movieOverview,children:["Overview: ",e.overview]}),o.jsx(y,{className:r.movieButton,onClick:w,children:"Add to favorites"})]})]})]})};export{$ as MoviePage,$ as default};
