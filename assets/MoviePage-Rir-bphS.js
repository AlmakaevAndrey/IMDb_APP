import{b as y,c as N,r as s,j as o,L as j,B as A,a as h,A as g}from"./index-BKNVy4Qs.js";import{d as P}from"./delayFn-Cv9sn8sE.js";const S="_container_1o96b_1",D="_moviePosterAndTrailer_1o96b_19",I="_moviePoster_1o96b_19",W="_movieTrailer_1o96b_57",E="_formContainer_1o96b_75",O="_formTitle_1o96b_101",R="_formWrapper_1o96b_115",B="_movieReleaseDate_1o96b_147",F="_movieVoteAverage_1o96b_151",$="_movieGenreIds_1o96b_153",C="_movieDownWrapper_1o96b_165",G="_movieOverview_1o96b_179",M="_movieButton_1o96b_355",r={container:S,moviePosterAndTrailer:D,moviePoster:I,movieTrailer:W,formContainer:E,formTitle:O,formWrapper:R,movieReleaseDate:B,movieVoteAverage:F,movieGenreIds:$,movieDownWrapper:C,movieOverview:G,movieButton:M},V=()=>{var _;const{id:i}=y(),l=N(),[e,b]=s.useState(null),[c,m]=s.useState(!1),[n,v]=s.useState(!1),[d,x]=s.useState(null);if(s.useEffect(()=>{(async()=>{try{v(!0),await P(1e3);const t=await h.get(`https://api.themoviedb.org/3/movie/${i}?api_key=${g}&language=en-US`);b(t.data),m(!1)}catch(t){console.error("Failed fetch:",t),m(!0)}finally{v(!1)}})()},[i]),s.useEffect(()=>{(async()=>{try{const f=(await h.get(`https://api.themoviedb.org/3/movie/${i}/videos?api_key=${g}&language=en-US`)).data.results.find(u=>u.type==="Trailer"&&u.site==="YouTube");f&&x(f.key)}catch(t){console.error("Failed to fetch trailer",t)}})()},[i]),s.useEffect(()=>{!n&&c&&l("/forbidden")},[n,c,l]),n)return o.jsx(j,{});if(!e)return null;const w=e.poster_path?`https://image.tmdb.org/t/p/w500${e.poster_path}`:"https://via.placeholder.com/500x750?text=No+Poster",T=()=>{const a=JSON.parse(localStorage.getItem("favorites")||"[]");a.some(p=>p.id===e.id)?alert("This movie has already been added!"):(localStorage.setItem("favorites",JSON.stringify([...a,e])),alert("Film was added!"))};return o.jsxs("div",{className:r.container,children:[o.jsxs("div",{className:r.moviePosterAndTrailer,children:[o.jsx("img",{loading:"lazy",src:w,alt:e==null?void 0:e.title,className:r.moviePoster}),d&&o.jsx("iframe",{className:r.movieTrailer,src:`https://www.youtube.com/embed/${d}`,title:"YouTube trailer",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})]}),o.jsxs("div",{className:r.formContainer,children:[o.jsx("h1",{className:r.formTitle,children:e.original_title}),o.jsxs("div",{className:r.formWrapper,children:[o.jsxs("h3",{className:r.movieReleaseDate,children:["Release: ",e.release_date]}),o.jsxs("h4",{className:r.movieVoteAverage,children:["Rating: ",e!=null&&e.vote_average?e.vote_average.toFixed(1):"No rating"]}),o.jsxs("h4",{className:r.movieGenreIds,children:["Genres: ",(_=e==null?void 0:e.genres)==null?void 0:_.map(a=>a.name).join(", ")]})]}),o.jsxs("div",{className:r.movieDownWrapper,children:[o.jsxs("p",{className:r.movieOverview,children:["Overview: ",e.overview]}),o.jsx(A,{className:r.movieButton,onClick:T,children:"Add to favorites"})]})]})]})};export{V as MoviePage,V as default};
