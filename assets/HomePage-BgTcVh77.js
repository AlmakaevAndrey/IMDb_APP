import{u as S,r as e,j as a,S as F,F as y,L as b,M as W,P as L,A as N,a as R}from"./index-BKNVy4Qs.js";import{d as E}from"./delayFn-Cv9sn8sE.js";const T="_homeWrapper_11pmt_1",w="_searchMovieWrapper_11pmt_27",I="_controlsContainer_11pmt_47",k="_MovieFilters_11pmt_71",n={homeWrapper:T,searchMovieWrapper:w,controlsContainer:I,MovieFilters:k},A=s=>{const r={};return s.genre&&(r.with_genres=s.genre),s.rating&&(r["vote_average.gte"]=s.rating),s.year&&(r["release_date.gte"]=`${s.year}-01-01`,r["release_date.lte"]=`${s.year}-12-31`),r},V=()=>{const[s,r]=S(),l=Number(s.get("page"))||1,[p,v]=e.useState({}),[o,_]=e.useState(""),[M,m]=e.useState(!1),[h,g]=e.useState(null),[t,f]=e.useState(null),c=e.useRef(null),x=e.useRef();e.useEffect(()=>(c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{(async()=>{m(!0),g(null),await E(1e3);const C=o.trim()?"https://api.themoviedb.org/3/search/movie":"https://api.themoviedb.org/3/discover/movie",u={api_key:N,language:"en-US",page:l};o.trim()?u.query=o.trim():Object.assign(u,A(p));try{const d=await R.get(C,{params:u});f(d.data)}catch{g("")}finally{m(!1)}})()},400),()=>clearTimeout(c.current)),[o,p,l]);const j=e.useCallback(i=>{r({page:i})},[r]),P=e.useMemo(()=>Math.min((t==null?void 0:t.total_pages)||1,10),[t]);return a.jsxs("div",{className:n.homeWrapper,children:[a.jsx("h1",{children:"Movies on TMDB"}),a.jsx("div",{className:n.controlsContainer,ref:x,children:a.jsxs("div",{className:n.searchMovieWrapper,children:[a.jsx(F,{value:o,onChange:i=>_(i.target.value)}),a.jsx(y,{onFilterChange:v,className:n.MovieFilters})]})}),M&&a.jsx(b,{}),h&&a.jsx("div",{className:n.error,children:h}),a.jsx(W,{movies:(t==null?void 0:t.results)||[]}),a.jsx(L,{totalPages:P,currentPage:l,onPageHandlerChange:j})]})};export{V as default};
