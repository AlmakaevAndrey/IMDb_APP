import{j as e,B as N,r as s,a as C,A as y,u as W,L as z,M as F,d as P}from"./index-CJxXfh7D.js";const b="_homeWrapper_11pmt_1",I="_searchMovieWrapper_11pmt_27",E="_controlsContainer_11pmt_47",G="_MovieFilters_11pmt_71",p={homeWrapper:b,searchMovieWrapper:I,controlsContainer:E,MovieFilters:G},L="_pagination_ysf0h_1",f={pagination:L},A=({totalPages:t,currentPage:n,onPageHandlerChange:o})=>{const l=Math.min(t,20);return t<2?null:e.jsx("div",{className:f.pagination,children:Array.from({length:l},(c,r)=>r+1).map(c=>e.jsx(N,{onClick:()=>o(c),isActive:c===n,className:f.pageButton,children:c},c))})},B="_filtersWrapper_83w79_1",$={filtersWrapper:B},Y=({onFilterChange:t})=>{const[n,o]=s.useState([]),[l,c]=s.useState(""),[r,g]=s.useState(""),[h,m]=s.useState("");return s.useEffect(()=>{(async()=>{try{const u=await C.get(`https://api.themoviedb.org/3/genre/movie/list?api_key=${y}&language=en-US`);o(u.data.genres)}catch(u){console.error("Failed to load genres!",u)}})()},[]),s.useEffect(()=>{t({genre:r,year:l,rating:h})},[r,l,h,t]),e.jsxs("div",{className:$.filtersWrapper,children:[e.jsxs("select",{value:r,onChange:a=>g(a.target.value),children:[e.jsx("option",{value:"",children:"Genres"}),n.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsxs("select",{value:l,onChange:a=>c(a.target.value),children:[e.jsx("option",{value:"",children:"Years"}),Array.from({length:30},(a,u)=>{const i=new Date().getFullYear()-u;return e.jsx("option",{value:i,children:i},i)})]}),e.jsxs("select",{value:h,onChange:a=>m(a.target.value),children:[e.jsx("option",{value:"",children:"Rating"}),e.jsx("option",{value:"7",children:"Rating +5"}),e.jsx("option",{value:"7",children:"Rating +6"}),e.jsx("option",{value:"7",children:"Rating +7"}),e.jsx("option",{value:"8",children:"Rating +8"}),e.jsx("option",{value:"9",children:"Rating +9"})]})]})},k="_inputContainer_tf3x4_1",T="_movieIcon_tf3x4_21",U="_input_tf3x4_1",j={inputContainer:k,movieIcon:T,input:U},H=()=>e.jsx("svg",{id:"Layer_1",width:20,height:20,fill:"white",enableBackground:"new 0 0 100.4 100.4",viewBox:"0 0 100.4 100.4",xmlns:"http://www.w3.org/2000/svg",children:e.jsxs("g",{children:[e.jsx("path",{d:"m38.5 43.5c6.7 0 12.4-4.2 14.6-10.1 2.2 5.9 7.9 10.1 14.6 10.1 8.6 0 15.6-7 15.6-15.6s-7-15.6-15.6-15.6c-6.7 0-12.4 4.2-14.6 10.1-2.2-5.9-7.9-10.1-14.6-10.1-8.6 0-15.6 7-15.6 15.6s7 15.6 15.6 15.6zm29.2-28.3c7 0 12.6 5.7 12.6 12.6 0 7-5.7 12.6-12.6 12.6-7 0-12.6-5.7-12.6-12.6s5.6-12.6 12.6-12.6zm-29.2 0c7 0 12.6 5.7 12.6 12.6s-5.7 12.6-12.6 12.6c-7 0-12.6-5.7-12.6-12.6s5.6-12.6 12.6-12.6z"}),e.jsx("path",{d:"m90.2 57.8h-7.3v-8c0-.8-.7-1.5-1.5-1.5h-55.5c-.8 0-1.5.7-1.5 1.5v12.5l-18-7.9c-.5-.2-1-.2-1.4.1s-.7.7-.7 1.3v24.4c0 .5.3 1 .7 1.3.2.2.5.2.8.2.2 0 .4 0 .6-.1l18-7.9v12.5c0 .8.7 1.5 1.5 1.5h55.5c.8 0 1.5-.7 1.5-1.5v-8h7.3c.8 0 1.5-.7 1.5-1.5v-17.4c0-.8-.7-1.5-1.5-1.5zm-65.8 12.7-17.1 7.5v-19.8l17.1 7.5h.1zm55.5 14.3h-52.5v-33.4h52.5v8 17.5zm8.8-9.5h-5.8v-14.5h5.8z"}),e.jsx("path",{d:"m38.5 34.4c3.6 0 6.5-2.9 6.5-6.5s-2.9-6.5-6.5-6.5-6.5 2.9-6.5 6.4 2.9 6.6 6.5 6.6zm0-10.1c1.9 0 3.5 1.6 3.5 3.5s-1.6 3.5-3.5 3.5-3.5-1.5-3.5-3.5 1.6-3.5 3.5-3.5z"}),e.jsx("path",{d:"m67.7 34.4c3.6 0 6.5-2.9 6.5-6.5s-2.9-6.5-6.5-6.5-6.5 2.9-6.5 6.5 2.9 6.5 6.5 6.5zm0-10.1c1.9 0 3.5 1.6 3.5 3.5s-1.6 3.5-3.5 3.5-3.5-1.6-3.5-3.5 1.6-3.5 3.5-3.5z"})]})}),V=({value:t,onChange:n})=>{const o=s.useId();return e.jsxs("div",{className:j.inputContainer,children:[e.jsx("label",{htmlFor:o}),e.jsx(H,{className:j.movieIcon}),e.jsx("input",{type:"text",id:o,className:j.input,placeholder:" search movie...",value:t,onChange:n})]})},q=t=>{const n={};return t.genre&&(n.with_genres=t.genre),t.rating&&(n["vote_average.gte"]=t.rating),t.year&&(n["release_date.gte"]=`${t.year}-01-01`,n["release_date.lte"]=`${t.year}-12-31`),n},K=()=>{const[t,n]=W(),o=Number(t.get("page"))||1,[l,c]=s.useState({}),[r,g]=s.useState(""),[h,m]=s.useState(!1),[a,u]=s.useState(null),[i,M]=s.useState(null),v=s.useRef(null),S=s.useRef();s.useEffect(()=>(v.current&&clearTimeout(v.current),v.current=setTimeout(()=>{(async()=>{m(!0),await P(1e3),u(null);const R=r.trim()?"https://api.themoviedb.org/3/search/movie":"https://api.themoviedb.org/3/discover/movie",x={api_key:y,language:"en-US",page:o};r.trim()?x.query=r.trim():Object.assign(x,q(l));try{const _=await C.get(R,{params:x});M(_.data)}catch{u("")}finally{m(!1)}})()},400),()=>clearTimeout(v.current)),[r,l,o]);const w=d=>{n({page:d})};return e.jsxs("div",{className:p.homeWrapper,children:[e.jsx("h1",{children:"Movies on TMDB"}),e.jsx("div",{className:p.controlsContainer,ref:S,children:e.jsxs("div",{className:p.searchMovieWrapper,children:[e.jsx(V,{value:r,onChange:d=>g(d.target.value)}),e.jsx(Y,{onFilterChange:c,className:p.MovieFilters})]})}),h&&e.jsx(z,{}),a&&e.jsx("div",{className:p.error,children:a}),e.jsx(F,{movies:(i==null?void 0:i.results)||[]}),e.jsx(A,{totalPages:Math.min((i==null?void 0:i.total_pages)||1,10),currentPage:o,onPageHandlerChange:w})]})};export{K as default};
